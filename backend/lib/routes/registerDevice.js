import QRCode from 'qrcode';
import { WrappedConsole } from '../utils/wrappedConsole.js';
import { v4 as uuidv4 } from 'uuid';
// import { PassThrough } from 'stream';

export const registerDevice = async (req, res) => {
  const wrappedConsole = new WrappedConsole("POST");
  let formData = JSON.parse(JSON.stringify(req.body));
  console.log(formData, "formData");
  const internalId = uuidv4();
  const url = process.env.DOMAIN + "/device?id=" + internalId;
  const urlQrCode = await QRCode.toDataURL(text);
  console.log(urlQrCode, internalId);
  s3Put(urlQrCode, internalId);
  device = {
    ...device,
    internalId
  };
  res.send("Device registered");
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJRUkNvZGUiLCJXcmFwcGVkQ29uc29sZSIsInY0IiwidXVpZHY0IiwicmVnaXN0ZXJEZXZpY2UiLCJyZXEiLCJyZXMiLCJ3cmFwcGVkQ29uc29sZSIsImZvcm1EYXRhIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwiYm9keSIsImNvbnNvbGUiLCJsb2ciLCJpbnRlcm5hbElkIiwidXJsIiwicHJvY2VzcyIsImVudiIsIkRPTUFJTiIsInVybFFyQ29kZSIsInRvRGF0YVVSTCIsInRleHQiLCJzM1B1dCIsImRldmljZSIsInNlbmQiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvcm91dGVzL3JlZ2lzdGVyRGV2aWNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBRUkNvZGUgZnJvbSAncXJjb2RlJ1xuaW1wb3J0IHsgV3JhcHBlZENvbnNvbGUgfSBmcm9tICcuLi91dGlscy93cmFwcGVkQ29uc29sZS5qcydcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xuLy8gaW1wb3J0IHsgUGFzc1Rocm91Z2ggfSBmcm9tICdzdHJlYW0nO1xuXG5cbmV4cG9ydCBjb25zdCByZWdpc3RlckRldmljZSA9IGFzeW5jKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3Qgd3JhcHBlZENvbnNvbGUgPSBuZXcgV3JhcHBlZENvbnNvbGUoXCJQT1NUXCIpXG4gICAgbGV0IGZvcm1EYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXEuYm9keSkpXG4gICAgY29uc29sZS5sb2coZm9ybURhdGEsXCJmb3JtRGF0YVwiKTtcbiAgICBjb25zdCBpbnRlcm5hbElkID0gdXVpZHY0KCk7XG4gICAgY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuRE9NQUlOICsgXCIvZGV2aWNlP2lkPVwiICtpbnRlcm5hbElkXG4gICAgY29uc3QgdXJsUXJDb2RlID0gYXdhaXQgUVJDb2RlLnRvRGF0YVVSTCh0ZXh0KVxuICAgIGNvbnNvbGUubG9nKHVybFFyQ29kZSwgaW50ZXJuYWxJZCk7XG4gICAgczNQdXQodXJsUXJDb2RlLGludGVybmFsSWQpXG4gICAgZGV2aWNlID0gey4uLmRldmljZSwgaW50ZXJuYWxJZH1cbiAgICByZXMuc2VuZChcIkRldmljZSByZWdpc3RlcmVkXCIpXG4gIH0iXSwibWFwcGluZ3MiOiJBQUFBLE9BQU9BLE1BQU0sTUFBTSxRQUFRO0FBQzNCLFNBQVNDLGNBQWMsUUFBUSw0QkFBNEI7QUFDM0QsU0FBU0MsRUFBRSxJQUFJQyxNQUFNLFFBQVEsTUFBTTtBQUNuQzs7QUFHQSxPQUFPLE1BQU1DLGNBQWMsR0FBRyxNQUFBQSxDQUFNQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUM3QyxNQUFNQyxjQUFjLEdBQUcsSUFBSU4sY0FBYyxDQUFDLE1BQU0sQ0FBQztFQUNqRCxJQUFJTyxRQUFRLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLFNBQVMsQ0FBQ04sR0FBRyxDQUFDTyxJQUFJLENBQUMsQ0FBQztFQUNuREMsT0FBTyxDQUFDQyxHQUFHLENBQUNOLFFBQVEsRUFBQyxVQUFVLENBQUM7RUFDaEMsTUFBTU8sVUFBVSxHQUFHWixNQUFNLENBQUMsQ0FBQztFQUMzQixNQUFNYSxHQUFHLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxNQUFNLEdBQUcsYUFBYSxHQUFFSixVQUFVO0VBQzFELE1BQU1LLFNBQVMsR0FBRyxNQUFNcEIsTUFBTSxDQUFDcUIsU0FBUyxDQUFDQyxJQUFJLENBQUM7RUFDOUNULE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTSxTQUFTLEVBQUVMLFVBQVUsQ0FBQztFQUNsQ1EsS0FBSyxDQUFDSCxTQUFTLEVBQUNMLFVBQVUsQ0FBQztFQUMzQlMsTUFBTSxHQUFHO0lBQUMsR0FBR0EsTUFBTTtJQUFFVDtFQUFVLENBQUM7RUFDaENULEdBQUcsQ0FBQ21CLElBQUksQ0FBQyxtQkFBbUIsQ0FBQztBQUMvQixDQUFDIn0=