import { WrappedConsole } from '../utils/index.js';
import { v4 as uuidv4 } from 'uuid';
import { dbPut } from '../cloudFunctions/index.js';
import { uploadQrCode } from '../uploadQrCode/index.js';
export const registerAsset = async (req, res) => {
  const wrappedConsole = new WrappedConsole("POST", "/registerAsset");
  let asset = JSON.parse(JSON.stringify(req.body));
  const internalId = uuidv4() + "" + asset.serialNo;
  const creationDate = Date.now() + "";
  const url = process.env.DOMAIN + "/device?id=" + internalId + "&creationDate=" + creationDate;
  asset = {
    ...asset,
    internalId,
    url,
    creationDate
  };
  let qrCode = await uploadQrCode(asset, wrappedConsole);
  // let dbUpdate = await dbPut(asset, wrappedConsole)
  if (!qrCode) {
    res.send(false);
  } else {
    res.send("Asset registered successfully");
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJXcmFwcGVkQ29uc29sZSIsInY0IiwidXVpZHY0IiwiZGJQdXQiLCJ1cGxvYWRRckNvZGUiLCJyZWdpc3RlckFzc2V0IiwicmVxIiwicmVzIiwid3JhcHBlZENvbnNvbGUiLCJhc3NldCIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsImJvZHkiLCJpbnRlcm5hbElkIiwic2VyaWFsTm8iLCJjcmVhdGlvbkRhdGUiLCJEYXRlIiwibm93IiwidXJsIiwicHJvY2VzcyIsImVudiIsIkRPTUFJTiIsInFyQ29kZSIsInNlbmQiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvcm91dGVzL3JlZ2lzdGVyQXNzZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV3JhcHBlZENvbnNvbGUgfSBmcm9tICcuLi91dGlscy9pbmRleC5qcydcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IHsgZGJQdXQgfSBmcm9tICcuLi9jbG91ZEZ1bmN0aW9ucy9pbmRleC5qcyc7XG5pbXBvcnQgeyB1cGxvYWRRckNvZGUgfSBmcm9tICcuLi91cGxvYWRRckNvZGUvaW5kZXguanMnO1xuXG5leHBvcnQgY29uc3QgcmVnaXN0ZXJBc3NldCA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICBjb25zdCB3cmFwcGVkQ29uc29sZSA9IG5ldyBXcmFwcGVkQ29uc29sZShcIlBPU1RcIiwgXCIvcmVnaXN0ZXJBc3NldFwiKVxuICBsZXQgYXNzZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlcS5ib2R5KSlcbiAgY29uc3QgaW50ZXJuYWxJZCA9IHV1aWR2NCgpICsgXCJcIiArIGFzc2V0LnNlcmlhbE5vO1xuICBjb25zdCBjcmVhdGlvbkRhdGUgPSBEYXRlLm5vdygpICsgXCJcIlxuICBjb25zdCB1cmwgPSBwcm9jZXNzLmVudi5ET01BSU4gKyBcIi9kZXZpY2U/aWQ9XCIgKyBpbnRlcm5hbElkICsgXCImY3JlYXRpb25EYXRlPVwiICsgY3JlYXRpb25EYXRlXG4gIGFzc2V0ID0geyAuLi5hc3NldCwgaW50ZXJuYWxJZCwgdXJsLCBjcmVhdGlvbkRhdGUgfVxuICBsZXQgcXJDb2RlID0gYXdhaXQgdXBsb2FkUXJDb2RlKGFzc2V0LCB3cmFwcGVkQ29uc29sZSlcbiAgLy8gbGV0IGRiVXBkYXRlID0gYXdhaXQgZGJQdXQoYXNzZXQsIHdyYXBwZWRDb25zb2xlKVxuICBpZiAoIXFyQ29kZSApIHtcbiAgICByZXMuc2VuZChmYWxzZSlcbiAgfVxuICBlbHNlIHtcbiAgICByZXMuc2VuZChcIkFzc2V0IHJlZ2lzdGVyZWQgc3VjY2Vzc2Z1bGx5XCIpXG4gIH1cblxufSJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsY0FBYyxRQUFRLG1CQUFtQjtBQUNsRCxTQUFTQyxFQUFFLElBQUlDLE1BQU0sUUFBUSxNQUFNO0FBQ25DLFNBQVNDLEtBQUssUUFBUSw0QkFBNEI7QUFDbEQsU0FBU0MsWUFBWSxRQUFRLDBCQUEwQjtBQUV2RCxPQUFPLE1BQU1DLGFBQWEsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMvQyxNQUFNQyxjQUFjLEdBQUcsSUFBSVIsY0FBYyxDQUFDLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQztFQUNuRSxJQUFJUyxLQUFLLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLFNBQVMsQ0FBQ04sR0FBRyxDQUFDTyxJQUFJLENBQUMsQ0FBQztFQUNoRCxNQUFNQyxVQUFVLEdBQUdaLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHTyxLQUFLLENBQUNNLFFBQVE7RUFDakQsTUFBTUMsWUFBWSxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRTtFQUNwQyxNQUFNQyxHQUFHLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxNQUFNLEdBQUcsYUFBYSxHQUFHUixVQUFVLEdBQUcsZ0JBQWdCLEdBQUdFLFlBQVk7RUFDN0ZQLEtBQUssR0FBRztJQUFFLEdBQUdBLEtBQUs7SUFBRUssVUFBVTtJQUFFSyxHQUFHO0lBQUVIO0VBQWEsQ0FBQztFQUNuRCxJQUFJTyxNQUFNLEdBQUcsTUFBTW5CLFlBQVksQ0FBQ0ssS0FBSyxFQUFFRCxjQUFjLENBQUM7RUFDdEQ7RUFDQSxJQUFJLENBQUNlLE1BQU0sRUFBRztJQUNaaEIsR0FBRyxDQUFDaUIsSUFBSSxDQUFDLEtBQUssQ0FBQztFQUNqQixDQUFDLE1BQ0k7SUFDSGpCLEdBQUcsQ0FBQ2lCLElBQUksQ0FBQywrQkFBK0IsQ0FBQztFQUMzQztBQUVGLENBQUMifQ==